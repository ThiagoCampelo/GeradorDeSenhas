unit Main;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants,
  System.Classes, Vcl.Graphics, Vcl.Controls, Vcl.Forms, Vcl.Dialogs, AdvPanel,
  Vcl.ExtCtrls, ToolPanels, Vcl.StdCtrls, AdvLabel, AdvGrid, AsgLinks, AdvEdit,
  AdvEdBtn, Vcl.Mask, RzEdit, RzPanel, RzRadGrp, RzButton, RzRadChk, AeroButtons,
  RzLabel, RzCmboBx, System.Hash, IdHashMessageDigest, Vcl.Clipbrd;

type
  TForm1 = class(TForm)
    AdvPanel1: TAdvPanel;
    AdvPanel2: TAdvPanel;
    AdvLabel1: TAdvLabel;
    lblTamSenha: TAdvLabel;
    cbMaius: TRzCheckBox;
    RzPanel1: TRzPanel;
    cbMinus: TRzCheckBox;
    cbNums: TRzCheckBox;
    cbEspecis: TRzCheckBox;
    btnGerar: TAeroButton;
    cbHashQuest: TRzCheckBox;
    pnlHash: TRzPanel;
    RzLabel1: TRzLabel;
    edtSemente: TRzEdit;
    edtTamanhoSenha: TRzComboBox;
    edtSenha: TRzEdit;
    RzLabel2: TRzLabel;
    AdvLabel3: TAdvLabel;
    memSenhaGerada: TMemo;
    procedure FormShow(Sender: TObject);
    procedure cbHashQuestClick(Sender: TObject);
    procedure btnGerarClick(Sender: TObject);
  private
    function HashMd5(const Valor, Semente: string): string;
    function SenhaHasheada: string;
    function SenhaAleatoria: string;
  public
    { Public declarations }
  end;

var
  Form1: TForm1;

implementation

{$R *.dfm}

function TForm1.HashMD5(const Valor, Semente: string): string;
var
  MD5: TIdHashMessageDigest5;
begin
  MD5 := TIdHashMessageDigest5.Create;
  try
    Result := MD5.HashStringAsHex(Semente + Valor + Semente);
  finally
    MD5.Free;
  end;

end;

function TForm1.SenhaHasheada: string;
var
  Senha, Semente, SenhaGerada: string;
begin
  Senha := edtSenha.Text;
  Semente := edtSemente.Text;

  SenhaGerada := HashMd5(Senha, Semente);

  if (Senha = '') or (Semente = '') then
  begin
    edtSenha.SetFocus;
    raise Exception.Create('Por favor, preencha a Senha e a Semente para gerar!');
  end
  else
  begin
    memSenhaGerada.Text := SenhaGerada;
    edtSenha.Clear;
    edtSemente.Clear;
    memSenhaGerada.ReadOnly := False;

    Clipboard.AsText := SenhaGerada;
    ShowMessage('A senha foi copiada para a área de transferência!');
  end;
end;

function TForm1.SenhaAleatoria: string;
begin

end;

procedure TForm1.btnGerarClick(Sender: TObject);
begin
  if cbHashQuest.Checked then
  begin
    SenhaHasheada;
  end;
  memSenhaGerada.SetFocus;
end;

procedure TForm1.cbHashQuestClick(Sender: TObject);
begin
  if cbHashQuest.Checked then
  begin
    pnlHash.Visible := True;
    edtSenha.SetFocus;
    cbNums.Enabled := False;
    cbMaius.Enabled := False;
    cbMinus.Enabled := False;
    cbEspecis.Enabled := False;
    edtTamanhoSenha.Enabled := False;
  end
  else
  begin
    pnlHash.Visible := False;
    btnGerar.SetFocus;
    cbNums.Enabled := True;
    cbMaius.Enabled := True;
    cbMinus.Enabled := True;
    cbEspecis.Enabled := True;
    edtTamanhoSenha.Enabled := True;
  end;
  memSenhaGerada.Clear;
end;

procedure TForm1.FormShow(Sender: TObject);
begin
  pnlHash.Visible := False;
end;

end.

